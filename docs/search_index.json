[["bookdown_lite.html", "BLI data of G3BP1-NTF2 binding to Caprin-1 and USP10 1 Script info 2 Data import 3 Pre-Plots 3.1 Dose-response data points obtained from titration data 3.2 Sensor Loads 3.3 Background binding of NTF2 to sensor surface 3.4 Sensor immobilization levels 3.5 Sensor stability 3.6 Hill fit to pseudo-equilibrium data 3.7 mutant control data 4 assembles figures 4.1 main figure 4.2 supplement figure", " BLI data of G3BP1-NTF2 binding to Caprin-1 and USP10 [Tim Schulte] 1 Script info BLI/Octet data deposited as Supplemental data on DRYAD. 2 Data import Data were pre-processed and analyzed using the ForteBio software. Raw and processed data were imported into R using the script below. not all loaded libraries are required. library(ggplot2) library(tidyverse) library(plyr) library(tidyr) library(readr) library(readxl) library(knitr) #library(nls) library(nlstools) library(nlshelper) library(minpack.lm) library(broom) library(nls.multstart) library(purrr) library(gnm) library(visreg) library(KRLS) library(glmnet) library(glmnetUtils) library(magrittr) library(forcats) library(emmeans) library(modelr) library(cowplot) library(ggridges) library(ggrepel) library(ggforce) library(fitdistrplus) library(MASS) library(hexbin) library(dMod) library(kimisc) library(ggsci) library(bookdown) library(tinytex) library(kableExtra) library(DT) library(xfun) ###from stackoverflow #&#39; @title pr_mutate_when #&#39; @description mutate a column within a dplyr pype only on a subset of rows #&#39; specified by a condition #&#39; Retrieved from a StackOverflow answer (https://stackoverflow.com/a/34170176/6871135) #&#39; @param data a `data.frame` (or `tibble` or `data.table`) #&#39; @param ... expression to be evaluated to filter on rows #&#39; @return `data frame` #&#39; @details DETAILS #&#39; @examples #&#39; \\dontrun{ #&#39; library(magrittr) #&#39; mtcars %&gt;% mutate_when( #&#39; mpg &gt; 22, list(cyl = 100), #&#39; disp == 160, list(cyl = 200)) #&#39; #&#39; } #&#39; @rdname pr_mutate_when #&#39; @export #&#39; @author Kevin Ushey pr_mutate_when &lt;- function(data, ...) { dots &lt;- eval(substitute(alist(...))) for (i in seq(1, length(dots), by = 2)) { condition &lt;- eval(dots[[i]], envir = data) mutations &lt;- eval(dots[[i + 1]], envir = data[condition, , drop = FALSE]) data[condition, names(mutations)] &lt;- mutations } data } import all data ### data_overview_tib &lt;- tribble(~rec, ~exprun_digit, ~meas_type, &quot;BOTH&quot;, 5, &quot;mut&quot;, &quot;BOTH&quot;, 6, &quot;mut&quot;, &quot;BOTH&quot;, 7, &quot;mut&quot;, &quot;BOTH&quot;, 8, &quot;mut&quot;, &quot;BOTH&quot;, 9, &quot;mut&quot;, &quot;BOTH&quot;, 10, &quot;mut&quot;, &quot;BOTH&quot;, 11, &quot;mut&quot;, &quot;BOTH&quot;, 12, &quot;mut&quot;, &quot;BOTH&quot;, 13, &quot;mut&quot;, &quot;USP&quot;, 1, &quot;ini&quot;, &quot;USP&quot;, 2, &quot;tit&quot;, &quot;USP&quot;, 3, &quot;tit&quot;, &quot;USP&quot;, 4, &quot;tit&quot;, &quot;USP&quot;, 5, &quot;tit&quot;, &quot;USP&quot;, 6, &quot;tit&quot;, &quot;USP&quot;, 7, &quot;tit&quot;, &quot;USP&quot;, 9, &quot;tit&quot;, &quot;USP&quot;, 10, &quot;tit&quot;, &quot;USP&quot;, 11, &quot;tit&quot;, #&quot;USP&quot;, 12, &quot;phc&quot;, #&quot;USP&quot;, 13, &quot;phc&quot;, #&quot;USP&quot;, 14, &quot;phc&quot;, #&quot;USP&quot;, 15, &quot;phc&quot;, #&quot;USP&quot;, 16, &quot;phc&quot;, #&quot;USP&quot;, 17, &quot;phc&quot;, &quot;CAP&quot;, 4, &quot;tit&quot;, &quot;CAP&quot;, 5, &quot;tit&quot;, &quot;CAP&quot;, 7, &quot;tit&quot;, &quot;CAP&quot;, 8, &quot;phc&quot;, &quot;CAP&quot;, 9, &quot;tit&quot;, &quot;CAP&quot;, 10, &quot;tit&quot;, &quot;CAP&quot;, 11, &quot;tit&quot;, &quot;CAP&quot;, 14, &quot;tit&quot;, &quot;CAP&quot;, 15, &quot;tit&quot;, &quot;CAP&quot;, 16, &quot;tit&quot;, &quot;CAP&quot;, 17, &quot;tit&quot;, &quot;CAP&quot;, 18, &quot;tit&quot;, &quot;CAP&quot;, 19, &quot;tit&quot;) #&quot;CAP&quot;, 20, &quot;phc&quot;, #&quot;CAP&quot;, 21, &quot;phc&quot;, #&quot;CAP&quot;, 22, &quot;phc&quot;, #&quot;CAP&quot;, 23, &quot;phc&quot;) ### find all relevant files using a filename pattern. data_dir_all &lt;- enframe(list.dirs(path = &quot;./titrations&quot;, full.names = TRUE, recursive=FALSE)) %&gt;% mutate(filterme = str_detect(value,&quot;USP|CAP&quot;)) %&gt;% subset(filterme == &quot;TRUE&quot;) %&gt;% dplyr::select(-filterme,-name) %&gt;% mutate(dirname=paste(value,&quot;/&quot;,sep=&quot;&quot;)) %&gt;% mutate(fileslist = purrr::map(dirname, ~list.files(path = ., pattern = &quot;*.xls&quot;,recursive = FALSE))) %&gt;% unnest() %&gt;% mutate(sample_temp=str_extract(value,pattern=&quot;[:digit:]{6}xAR2Gx[:digit:][:digit:]xUSPxEXP[:digit:][:digit:]|[:digit:]{6}xAR2Gx[:digit:][:digit:]xCAPxEXP[:digit:][:digit:]|[:digit:]{6}xAR2Gx[:digit:][:digit:]xUSPCAPxEXP[:digit:][:digit:]&quot;)) %&gt;% mutate(sample=str_extract(sample_temp,pattern=&quot;AR2Gx[:digit:][:digit:]xUSPxEXP[:digit:][:digit:]|AR2Gx[:digit:][:digit:]xCAPxEXP[:digit:][:digit:]|AR2Gx[:digit:][:digit:]xUSPCAPxEXP[:digit:][:digit:]&quot;)) %&gt;% mutate(expnumber = str_extract(sample,pattern=&quot;EXP[:digit:][:digit:]&quot;)) %&gt;% mutate(., sample_test = str_extract(sample, &quot;USPCAP|USP|CAP&quot;)) %&gt;% mutate(., rec = case_when(sample_test == &quot;USP&quot; ~ sample_test, sample_test == &quot;CAP&quot; ~ sample_test, sample_test == &quot;USPCAP&quot; ~ &quot;BOTH&quot;, TRUE ~ &quot;STH&quot;)) %&gt;% mutate(., exprun = str_extract(expnumber, pattern = &quot;[:digit:][:digit:]&quot;)) %&gt;% mutate(., exprun_digit = as.numeric(exprun)) %&gt;% dplyr::select(-sample_temp, -exprun) %&gt;% left_join(., data_overview_tib) # ### filter sensor titration data data_dir_sensors &lt;- data_dir_all %&gt;% mutate(fileslist_filtered = str_detect(fileslist,pattern=&quot;^[:alnum:][:digit:].xls&quot;)) %&gt;% subset(fileslist_filtered == &quot;TRUE&quot;) %&gt;% unite(.,&quot;readme&quot;, c(&quot;dirname&quot;, &quot;fileslist&quot;),sep=&quot;&quot;) %&gt;% dplyr::select(-fileslist_filtered,-value, -expnumber, -sample_test) %&gt;% mutate(sensorid=str_extract(readme,pattern=&quot;[A-H][:digit:].xls&quot;)) %&gt;% mutate(sensorid=str_extract(readme,pattern=&quot;[A-H][:digit:]&quot;)) %&gt;% mutate(sensor=str_extract(sensorid,pattern=&quot;[A-H]&quot;)) %&gt;% unite(., col = &quot;sampleid&quot;, c(&quot;sample&quot;, &quot;sensorid&quot;), sep = &quot;_&quot;, remove = FALSE) %&gt;% dplyr::select(., readme, sampleid, rec, exprun_digit, meas_type, sensorid, sensor) ### filter sensor parameters (sensors, ligand, concentration): IMPORTANT: modify the results page of the xls report file; and save as tab del file (txt format); then rename to xls data_dir_all_pars &lt;- data_dir_all %&gt;% mutate(fileslist_filtered = str_detect(fileslist,pattern=&quot;^[:alnum:][:digit:].xls&quot;)) %&gt;% dplyr::filter(fileslist_filtered==&quot;FALSE&quot;) %&gt;% mutate(filtername = str_detect(fileslist,&quot;results.xls&quot;)) %&gt;% subset(filtername == &quot;TRUE&quot;) %&gt;% dplyr::select(-fileslist_filtered,-filtername) %&gt;% unite(.,&quot;readme&quot;, c(&quot;dirname&quot;, &quot;fileslist&quot;),sep=&quot;&quot;) %&gt;% dplyr::select(-value) %&gt;% mutate(parameters = purrr::map(readme,~read_tsv(.,skip=0, locale = locale(decimal_mark = &quot;.&quot;)))) %&gt;% mutate(parameters_sel = purrr::map(parameters, ~dplyr::select(.,sensorid=sensor,ligand,conc_nM = conc,type))) %&gt;% dplyr::select(sample, parameters_sel) %&gt;% unnest() %&gt;% unite(., col = &quot;sampleid&quot;, c(&quot;sample&quot;, &quot;sensorid&quot;), sep = &quot;_&quot;, remove = FALSE) data_dir_all_sensors_pars &lt;- data_dir_sensors %&gt;% group_by(., sampleid, readme, rec, exprun_digit, meas_type, sensorid, sensor) %&gt;% dplyr::summarize() %&gt;% right_join(., data_dir_all_pars) #%&gt;% mutate(sensorid=str_extract(readme,pattern=&quot;[A-H][:digit:]&quot;)) %&gt;% #mutate(sensor=str_extract(sensorid,pattern=&quot;[A-H]&quot;)) %&gt;% unite(., col = &quot;sampleid&quot;, c(&quot;sample&quot;, &quot;sensorid&quot;), sep = &quot;_&quot;, remove = FALSE) #data_dir_all_samples &lt;- data_dir_all %&gt;% group_by(sample) %&gt;% nest(.) ###combine parameters with sensor data #data_pall_csv_titrations data_dir_all_csv &lt;- data_dir_all_sensors_pars %&gt;% mutate(csv = purrr::map(readme,~read_tsv(.,skip=5, col_names = c(&quot;time&quot;,&quot;octet&quot;,&quot;simulated&quot;))) ) #data_pall_csv_conc_titrations #data_pall_csv_conc_titrations_ligand %&gt;% dplyr::filter(meas_type==&quot;tit&quot;) data_dir_all_csv_titrations &lt;- data_dir_all_csv %&gt;% ungroup() %&gt;% dplyr::select(-readme) %&gt;% mutate(conc_nM_dimer = conc_nM/2, csv_shifted = purrr::map(csv,~dplyr::mutate(.,time_shifted = time - min(time)))) %&gt;% dplyr::select(-csv) data_pall_csv_conc_titrations_eq &lt;- data_dir_all_csv_titrations %&gt;% mutate(csv_shifted_eqphase = purrr::map(csv_shifted, ~filter(.,time_shifted &gt; 1150 &amp; time_shifted &lt; 1200))) %&gt;% mutate(csv_shifted_eqvalue = purrr::map(csv_shifted_eqphase, ~summarize(.,octet_eq = mean(octet)))) %&gt;% unnest(., c(&quot;csv_shifted_eqvalue&quot;)) data_pall_csv_conc_titrations_eq_leftjoin &lt;- data_pall_csv_conc_titrations_eq %&gt;% dplyr::select(., sampleid, conc_nM_dimer, octet_eq) data_dir_all_csv_titrations_unnested &lt;- data_dir_all_csv_titrations %&gt;% left_join(., data_pall_csv_conc_titrations_eq_leftjoin) %&gt;% unnest(cols = c(&quot;csv_shifted&quot;)) %&gt;% group_by(., rec, meas_type) %&gt;% group_modify(., ~mutate(.,index=group_indices(.,exprun_digit))) %&gt;% ungroup() ### plot eq values against concentration: 1200s association #for (i in 1:3){dplyr::mutate(., sampleid_counter = row_number(rec_conc_plot)) %&gt;% dplyr::mutate(., plotme = case_when(plotme == &quot;plotme&quot; &amp; sampleid != &quot;AR2Gx05xCAPxEXP04_B5&quot; ~ plotme) ) # data_dir_all_csv_titrations_all_nested &lt;- data_dir_all_csv_titrations_unnested %&gt;% dplyr::filter(.,meas_type == &quot;tit&quot;) %&gt;% dplyr::filter(., rec == &quot;USP&quot; | (rec == &quot;CAP&quot; &amp; index &gt; 3)) %&gt;% group_by(., rec, meas_type, sampleid, exprun_digit, sensorid, sensor, sample, ligand, conc_nM, type, conc_nM_dimer, octet_eq, index) %&gt;% nest(.) %&gt;% dplyr::mutate(., conc_ranges = cut(conc_nM_dimer, breaks = c(0,0.99, 9.99, 49.9, 499, 999, 19999, Inf), labels = c(0, 1, 10, 50, 500, 1000, 20000))) %&gt;% dplyr::mutate(., sampleid_conc = paste(sampleid, conc_nM_dimer, sep =&quot;_&quot;)) %&gt;% group_by(., rec, conc_ranges) %&gt;% dplyr::arrange(., c(conc_nM_dimer), .by_group = TRUE) %&gt;% ungroup() %&gt;% group_by(., rec, conc_ranges) %&gt;% group_modify(., ~mutate(., median_octet = ((median(octet_eq)-octet_eq )^2)^0.5 )) %&gt;% group_modify(., ~mutate(., plotme = case_when(median_octet == min(median_octet) ~ &quot;plotme&quot;))) %&gt;% dplyr::mutate(., rec_conc_plot = paste(rec, plotme, conc_ranges, sep =&quot;_&quot;)) %&gt;% ungroup() %&gt;% group_by(rec, conc_ranges) %&gt;% group_modify(., ~mutate(., sampleid_counter = row_number(plotme))) 3 Pre-Plots 3.1 Dose-response data points obtained from titration data data_dir_all_csv_titrations_plot &lt;- data_dir_all_csv_titrations_all_nested %&gt;% drop_na(plotme) %&gt;% dplyr::filter(., sampleid_counter == 1) %&gt;% unnest(., cols = c(&quot;data&quot;)) %&gt;% ggplot(data=., aes(x=time_shifted, y=octet, colour=conc_nM_dimer, group = sampleid)) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + #geom_point(size = 2, stroke = 0.1, alpha=0.2, colour = &quot;black&quot;) + geom_line(size=0.5) + scale_x_continuous(&quot;time: min&quot;, breaks = c(0, 600, 1200, 1800, 2400), labels = function(breaks) ((breaks/60))) + scale_y_continuous(&quot;octet: nm&quot;, limits = c(0,1)) + scale_colour_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=2, trans = &quot;log10&quot;) + #, facet_grid(rec ~ .) + #facet_grid_paginate(index ~ rec, ncol=2, nrow=4, page = i) + theme_light() + theme(legend.position = &quot;none&quot;) print(data_dir_all_csv_titrations_plot) #ggsave(file=&quot;ggplot_ligand_ligand_temp.jpeg&quot;, plot=data_dir_all_csv_titrations_plot,device=&quot;jpeg&quot;) ggsave(file=&quot;./ggplot_ligand_ligand.jpeg&quot;, device=&quot;jpeg&quot;, width = 90, height = 90, units = c(&quot;mm&quot;)) #ggsave(file=&quot;./ggplot_ligand_ligand.ps&quot;, width = 60, height = 90, units = c(&quot;mm&quot;)) #} Plot used in panel B of supplemental Figure S4 in associated manuscript. data_pall_csv_conc_titrations_ligand_eq &lt;- data_pall_csv_conc_titrations_eq %&gt;% dplyr::filter(meas_type == &quot;tit&quot;) data_pall_csv_conc_titrations_ligand_eq_logplot &lt;- data_pall_csv_conc_titrations_ligand_eq %&gt;% ggplot(data=., aes(x=conc_nM_dimer, y=octet_eq, color=conc_nM_dimer, group=factor(sampleid))) + #xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + geom_point(size=2) + scale_x_log10(&quot;c(ntf2): nM&quot;) + scale_y_continuous(&quot;pseudo-eq octet: nm&quot;) + scale_color_gradient2(&quot;c(ntf2): nM&quot;, low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #, facet_grid(rec ~ .) + theme_light() print(data_pall_csv_conc_titrations_ligand_eq_logplot) ggsave(file=&quot;ggplot_ligand_titrations_eqconc_log.jpeg&quot;, plot=data_pall_csv_conc_titrations_ligand_eq_logplot,device=&quot;jpeg&quot;) #ggsave(file=&quot;ggplot_ligand_titrations_eqconc_log.ps&quot;, plot=data_pall_csv_conc_titrations_ligand_eq_logplot,device=&quot;ps&quot;) Pseudo-equilibrium octet values plotted against the NTF2-dimer concentration. 3.2 Sensor Loads Before continuing with data fitting and further analysis, the next chunk compares sensor loads of the CAP and USP ligands. ### filter sensor titration data sensor_spec_double &lt;- tribble(~.name, ~.value, ~sensor, ~group, &quot;A_time&quot;, &quot;time&quot;, &quot;A&quot;, &quot;AE&quot;, &quot;A_octet&quot;, &quot;octet&quot;, &quot;A&quot;,&quot;AE&quot;, &quot;B_time&quot;, &quot;time&quot;, &quot;B&quot;,&quot;BF&quot;, &quot;B_octet&quot;, &quot;octet&quot;, &quot;B&quot;,&quot;BF&quot;, &quot;C_time&quot;, &quot;time&quot;, &quot;C&quot;,&quot;CG&quot;, &quot;C_octet&quot;, &quot;octet&quot;, &quot;C&quot;,&quot;CG&quot;, &quot;D_time&quot;, &quot;time&quot;, &quot;D&quot;,&quot;DH&quot;, &quot;D_octet&quot;, &quot;octet&quot;, &quot;D&quot;,&quot;DH&quot;, &quot;E_time&quot;, &quot;time&quot;, &quot;E&quot;,&quot;AE&quot;, &quot;E_octet&quot;, &quot;octet&quot;, &quot;E&quot;,&quot;AE&quot;, &quot;F_time&quot;, &quot;time&quot;, &quot;F&quot;,&quot;BF&quot;, &quot;F_octet&quot;, &quot;octet&quot;, &quot;F&quot;,&quot;BF&quot;, &quot;G_time&quot;, &quot;time&quot;, &quot;G&quot;,&quot;CG&quot;, &quot;G_octet&quot;, &quot;octet&quot;, &quot;G&quot;,&quot;CG&quot;, &quot;H_time&quot;, &quot;time&quot;, &quot;H&quot;,&quot;DH&quot;, &quot;H_octet&quot;, &quot;octet&quot;, &quot;H&quot;, &quot;DH&quot;) #there was an error with sensor G; that one is missing in the data. so the importet G columns are in fact H columns sensor_spec_single &lt;- tribble(~.name, ~.value, ~sensor, ~group, &quot;A_time&quot;, &quot;time&quot;, &quot;A&quot;, &quot;ALL&quot;, &quot;A_octet&quot;, &quot;octet&quot;, &quot;A&quot;,&quot;ALL&quot;, &quot;B_time&quot;, &quot;time&quot;, &quot;B&quot;,&quot;ALL&quot;, &quot;B_octet&quot;, &quot;octet&quot;, &quot;B&quot;,&quot;ALL&quot;, &quot;C_time&quot;, &quot;time&quot;, &quot;C&quot;,&quot;ALL&quot;, &quot;C_octet&quot;, &quot;octet&quot;, &quot;C&quot;,&quot;ALL&quot;, &quot;D_time&quot;, &quot;time&quot;, &quot;D&quot;,&quot;ALL&quot;, &quot;D_octet&quot;, &quot;octet&quot;, &quot;D&quot;,&quot;ALL&quot;, &quot;E_time&quot;, &quot;time&quot;, &quot;E&quot;,&quot;ALL&quot;, &quot;E_octet&quot;, &quot;octet&quot;, &quot;E&quot;,&quot;ALL&quot;, &quot;F_time&quot;, &quot;time&quot;, &quot;F&quot;,&quot;ALL&quot;, &quot;F_octet&quot;, &quot;octet&quot;, &quot;F&quot;,&quot;ALL&quot;, &quot;G_time&quot;, &quot;time&quot;, &quot;G&quot;,&quot;ALL&quot;, &quot;G_octet&quot;, &quot;octet&quot;, &quot;G&quot;,&quot;ALL&quot;, &quot;H_time&quot;, &quot;time&quot;, &quot;H&quot;, &quot;ALL&quot;, &quot;H_octet&quot;, &quot;octet&quot;, &quot;H&quot;, &quot;ALL&quot;) data_dir_sensors_raw &lt;- enframe(list.files(path = &quot;./titrations_raw_data&quot;, full.names = TRUE, recursive=FALSE)) %&gt;% mutate(filterme = str_detect(value,&quot;USP|CAP&quot;)) %&gt;% subset(filterme == &quot;TRUE&quot;) %&gt;% dplyr::select(-filterme,-name) %&gt;% mutate(filename=value) %&gt;% mutate(sample_temp=str_extract(value,pattern=&quot;[:digit:]{6}xAR2Gx[:digit:][:digit:]xUSPxEXP[:digit:][:digit:]|[:digit:]{6}xAR2Gx[:digit:][:digit:]xCAPxEXP[:digit:][:digit:]|[:digit:]{6}xAR2Gx[:digit:][:digit:]xUSPCAPxEXP[:digit:][:digit:]&quot;)) %&gt;% mutate(sample=str_extract(sample_temp,pattern=&quot;AR2Gx[:digit:][:digit:]xUSPxEXP[:digit:][:digit:]|AR2Gx[:digit:][:digit:]xCAPxEXP[:digit:][:digit:]|AR2Gx[:digit:][:digit:]xUSPCAPxEXP[:digit:][:digit:]&quot;)) %&gt;% mutate(expnumber = str_extract(sample,pattern=&quot;EXP[:digit:][:digit:]&quot;)) %&gt;% mutate(., sample_test = str_extract(sample, &quot;USPCAP|USP|CAP&quot;)) %&gt;% mutate(., rec = case_when(sample_test == &quot;USP&quot; ~ sample_test, sample_test == &quot;CAP&quot; ~ sample_test, sample_test == &quot;USPCAP&quot; ~ &quot;BOTH&quot;, TRUE ~ &quot;STH&quot;)) %&gt;% mutate(., exprun = str_extract(expnumber, pattern = &quot;[:digit:][:digit:]&quot;)) %&gt;% mutate(., exprun_digit = as.numeric(exprun)) %&gt;% mutate(., meas_type = case_when(exprun_digit &lt; 3 ~ &quot;load_tit&quot;, TRUE ~ &quot;raw_tit&quot;)) pivot_longer_sensor_spec_f &lt;- function(df, refgroup){ if (refgroup == &quot;single&quot;){ df_out &lt;- df %&gt;% pivot_longer_spec(., sensor_spec_single) %&gt;% arrange(., sensor) %&gt;% drop_na(., time) } else { df_out &lt;- df %&gt;% pivot_longer_spec(., sensor_spec_double) %&gt;% arrange(., sensor) %&gt;% drop_na(., time) } return(df_out) } sensor_load_f &lt;- function(df, refgroup, end_time){ if (refgroup == &quot;double&quot;){ df_out &lt;- df %&gt;% dplyr::mutate(., AE_octet = A_octet-E_octet,BF_octet = B_octet-F_octet,CG_octet = C_octet-G_octet,DH_octet = D_octet-H_octet) %&gt;% dplyr::select(., time = A_time, AE_octet, BF_octet, CG_octet, DH_octet) %&gt;% pivot_longer(., cols = c(2:ncol(.))) %&gt;% arrange(., name) %&gt;% dplyr::filter(., time &gt; (end_time-0.1) &amp; time &lt; (end_time+0.1)) %&gt;% dplyr::select(., name, value) } else { df_out &lt;- df %&gt;% dplyr::mutate(., AG_octet = A_octet-G_octet,BG_octet = B_octet-G_octet,CG_octet = C_octet-G_octet, DG_octet = D_octet-G_octet, EG_octet = E_octet-G_octet, FG_octet = F_octet-G_octet) %&gt;% dplyr::select(., time = A_time, AG_octet, BG_octet, CG_octet, DG_octet, EG_octet, FG_octet) %&gt;% pivot_longer(., cols = c(2:ncol(.))) %&gt;% arrange(., name) %&gt;% dplyr::filter(., time &gt; (end_time-0.1) &amp; time &lt; (end_time+0.1)) %&gt;% dplyr::select(., name, value) } return(df_out) } sensor_times &lt;- tribble(~rec, ~exprun_digit, ~meas_type, ~end_time, ~refgroup, &quot;USP&quot;, 1, &quot;load_tit&quot;, 1500, &quot;double&quot;, &quot;CAP&quot;, 2, &quot;load_tit&quot;, 2750, &quot;double&quot;, &quot;BOTH&quot;, 1, &quot;load_tit&quot;, 2000, &quot;single&quot;) tit_sensor_times &lt;- tribble(~rec, ~meas_type,~start_time, ~end_time, &quot;USP&quot;, &quot;raw_tit&quot;, 400, 2500, &quot;CAP&quot;, &quot;raw_tit&quot;, 400, 2500) sensor_plot_f &lt;- function(df, end_time){ plot_obj &lt;- ggplot(data=df, aes(x=time, y=octet, color=sensor)) + #xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + geom_line(size=1) + scale_x_continuous(limits = c(0, end_time)) + theme_light() + scale_color_aaas() + #scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #, facet_grid(group ~ .) return(plot_obj) } sensor_load_pull_f &lt;- function(df, end_time){ df_value &lt;- df %&gt;% dplyr::filter(., time &gt; (end_time-0.1) &amp; time &lt; (end_time+0.1)) %&gt;% dplyr::select(., name, value) return(df_value) } ### plot sensor load kinetics ### for this particular dataset: sensor G in the &quot;BOTH&quot; receptor group had an error, and was not used during data export; ### thus G is in fact H! data_dir_sensors_raw_xls &lt;- data_dir_sensors_raw %&gt;% dplyr::filter(., meas_type == &quot;load_tit&quot;) %&gt;% dplyr::mutate(.,filterme = str_detect(filename, &quot;xlsx&quot;)) %&gt;% dplyr::filter(., filterme == &quot;TRUE&quot;) %&gt;% mutate(xls = purrr::map(filename,~read_xlsx(.,range = &quot;A2:P20000&quot;, col_names = c(&quot;A_time&quot;, &quot;A_octet&quot;, &quot;B_time&quot;, &quot;B_octet&quot;, &quot;C_time&quot;, &quot;C_octet&quot;, &quot;D_time&quot;, &quot;D_octet&quot;, &quot;E_time&quot;, &quot;E_octet&quot;, &quot;F_time&quot;, &quot;F_octet&quot;, &quot;G_time&quot;, &quot;G_octet&quot;,&quot;H_time&quot;, &quot;H_octet&quot;))) ) %&gt;% mutate(xls_comma = purrr::map(xls,~dplyr::mutate_if(.,is.character, as.double))) %&gt;% left_join(., sensor_times) %&gt;% mutate(xls_longer = purrr::pmap(list(xls_comma, refgroup), pivot_longer_sensor_spec_f)) %&gt;% dplyr::mutate(., sensor_plot = purrr::pmap(list(xls_longer,end_time),sensor_plot_f)) %&gt;% dplyr::mutate(., sensor_plot_name = paste(&quot;sensorload&quot;, rec, exprun_digit, meas_type, &quot;0.jpeg&quot;, sep =&quot;_&quot;)) %&gt;% mutate(xls_load = purrr::pmap(list(xls_comma,refgroup, end_time), sensor_load_f)) pwalk(list(data_dir_sensors_raw_xls$sensor_plot_name, data_dir_sensors_raw_xls$sensor_plot), ggsave) Plots saved as sensorload_.jpeg. Surfaces generated as described in M&amp;Ms of the manuscript: Titration experiments: sensorload_CAP_2_load_tit_0* and sensorload_USP_1_load_tit_0 Comparative experiments: sensorload_BOTH_1_load_tit_0 3.3 Background binding of NTF2 to sensor surface ### plot selected ligand titration kinetics as raw data: non-substracted sensor and ligand surfaces titration_plot_f &lt;- function(df, start_time, end_time){ plot_obj &lt;- ggplot(data=df, aes(x=time, y=octet, color=sensor_type)) + #xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + geom_line(size=1) + scale_x_continuous(limits = c(start_time, end_time)) + theme_light() + scale_color_aaas() + #scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #, facet_grid(group ~ .) return(plot_obj) } titraw_ref_pull_f &lt;- function(df, start_time){ df_value &lt;- df %&gt;% dplyr::filter(., time &gt; (start_time-50) &amp; time &lt; (start_time+50)) %&gt;% group_by(sensor) %&gt;% dplyr::summarize(., octet_ref = mean(octet)) %&gt;% dplyr::select(., sensor, octet_ref) return(df_value) } data_dir_sensors_raw_titration_xls &lt;- data_dir_sensors_raw %&gt;% dplyr::filter(., meas_type == &quot;raw_tit&quot;) %&gt;% dplyr::mutate(.,filterme = str_detect(filename, &quot;xlsx&quot;)) %&gt;% dplyr::filter(., filterme == &quot;TRUE&quot;) %&gt;% mutate(xls = purrr::map(filename,~read_xlsx(.,range = &quot;A2:P20000&quot;, col_names = c(&quot;A_time&quot;, &quot;A_octet&quot;, &quot;B_time&quot;, &quot;B_octet&quot;, &quot;C_time&quot;, &quot;C_octet&quot;, &quot;D_time&quot;, &quot;D_octet&quot;, &quot;E_time&quot;, &quot;E_octet&quot;, &quot;F_time&quot;, &quot;F_octet&quot;, &quot;G_time&quot;, &quot;G_octet&quot;,&quot;H_time&quot;, &quot;H_octet&quot;))) ) %&gt;% mutate(xls_comma = purrr::map(xls,~dplyr::mutate_if(.,is.character, as.double))) %&gt;% mutate(xls_longer = purrr::map(xls_comma,~pivot_longer_spec(., sensor_spec_double))) %&gt;% mutate(xls_longer_sorted = purrr::map(xls_longer,~arrange(., sensor))) %&gt;% mutate(xls_longer_sorted = purrr::map(xls_longer_sorted,~dplyr::mutate(., sensor_type = case_when(sensor == &quot;A&quot; ~ &quot;ligand&quot;, sensor == &quot;B&quot; ~ &quot;ligand&quot;, sensor == &quot;C&quot; ~ &quot;ligand&quot;, sensor == &quot;D&quot; ~ &quot;ligand&quot;, TRUE ~ &quot;reference&quot;)))) %&gt;% left_join(., tit_sensor_times) %&gt;% dplyr::mutate(., sensor_plot = purrr::pmap(list(xls_longer_sorted, start_time, end_time),titration_plot_f)) %&gt;% dplyr::mutate(., sensor_plot_name = paste(&quot;raw_tit&quot;, rec, exprun_digit, meas_type, &quot;0.jpeg&quot;, sep =&quot;_&quot;)) %&gt;% mutate(xls_load = purrr::map(xls_comma,~dplyr::mutate(., AE_octet = A_octet-E_octet,BF_octet = B_octet-F_octet,CG_octet = C_octet-G_octet,DH_octet = D_octet-H_octet))) %&gt;% mutate(xls_load = purrr::map(xls_load,~dplyr::select(., time = A_time, AE_octet, BF_octet, CG_octet, DH_octet))) %&gt;% mutate(xls_load_longer = purrr::map(xls_load,~pivot_longer(., cols = c(2:ncol(.)) ))) %&gt;% mutate(xls_load_sorted = purrr::map(xls_load_longer,~arrange(., name))) %&gt;% dplyr::mutate(ref_sub = purrr::pmap(list(xls_longer_sorted, start_time), titraw_ref_pull_f)) %&gt;% mutate(xls_longer_sorted_sub = purrr::pmap(list(xls_longer_sorted,ref_sub), left_join)) %&gt;% mutate(xls_longer_sorted_sub = purrr::map(xls_longer_sorted_sub, ~dplyr::mutate(., octet_sub = octet - octet_ref))) %&gt;% mutate(xls_longer_sorted_sub = purrr::map(xls_longer_sorted_sub, ~dplyr::select(., sensor, group, time, octet = octet_sub, sensor_type))) %&gt;% dplyr::mutate(., sensor_sub_plot = purrr::pmap(list(xls_longer_sorted_sub, start_time, end_time),titration_plot_f)) pwalk(list(data_dir_sensors_raw_titration_xls$sensor_plot_name, data_dir_sensors_raw_titration_xls$sensor_sub_plot), ggsave) Plots saved as sensorload_*.jpeg. Surfaces generated as described in M&amp;Ms of the manuscript. Titration experiments: sensorload_CAP_2_load_tit_0 and sensorload_USP_1_load_tit_0 Comparative experiments: sensorload_BOTH_1_load_tit_0 knitr::include_graphics(c(&quot;./raw_tit_CAP_19_raw_tit_0.jpeg&quot;)) Example for background binding to reference surface. Corresponding to sample name AR2Gx05xCAPxEXP19, with NTF2 concentrations of 0.04, 12, 1, and 0.4 uM from top to bottom. 3.4 Sensor immobilization levels sensor_plot_tribble &lt;- tribble(~rec, ~name, ~lig_type, ~ligand, ~fill, &quot;BOTH&quot;, &quot;AG_octet&quot;, &quot;MUT0&quot;, &quot;USP&quot;, &quot;A&quot;, &quot;BOTH&quot;, &quot;BG_octet&quot;, &quot;MUT0&quot;, &quot;USP&quot;, &quot;B&quot;, &quot;BOTH&quot;, &quot;CG_octet&quot;, &quot;MUT1&quot;, &quot;USP&quot;, &quot;C&quot;, &quot;BOTH&quot;, &quot;DG_octet&quot;, &quot;MUT0&quot;, &quot;CAP&quot;, &quot;A&quot;, &quot;BOTH&quot;, &quot;EG_octet&quot;, &quot;MUT0&quot;, &quot;CAP&quot;, &quot;B&quot;, &quot;BOTH&quot;, &quot;FG_octet&quot;, &quot;MUT1&quot;, &quot;CAP&quot;, &quot;C&quot;, &quot;USP&quot;, &quot;AE_octet&quot;, &quot;MUT0&quot;, &quot;USP&quot;, &quot;A&quot;, &quot;USP&quot;, &quot;BF_octet&quot;, &quot;MUT0&quot;, &quot;USP&quot;, &quot;B&quot;, &quot;USP&quot;, &quot;CG_octet&quot;, &quot;MUT0&quot;, &quot;USP&quot;, &quot;C&quot;, &quot;USP&quot;, &quot;DH_octet&quot;, &quot;MUT0&quot;, &quot;USP&quot;, &quot;D&quot;, &quot;CAP&quot;, &quot;AE_octet&quot;, &quot;MUT0&quot;, &quot;CAP&quot;, &quot;A&quot;, &quot;CAP&quot;, &quot;BF_octet&quot;, &quot;MUT0&quot;, &quot;CAP&quot;, &quot;B&quot;, &quot;CAP&quot;, &quot;CG_octet&quot;, &quot;MUT0&quot;, &quot;CAP&quot;, &quot;C&quot;, &quot;CAP&quot;, &quot;DH_octet&quot;, &quot;MUT0&quot;, &quot;CAP&quot;, &quot;D&quot;) data_dir_sensors_xls_colplot &lt;- data_dir_sensors_raw_xls %&gt;% drop_na(meas_type) %&gt;% dplyr::select(rec, exprun_digit, meas_type, xls_load) %&gt;% unnest(., c(&quot;xls_load&quot;)) %&gt;% left_join(., sensor_plot_tribble) %&gt;% dplyr::mutate(., boxgroup = paste(rec, ligand, lig_type, sep = &quot;_&quot;)) %&gt;% ggplot(., aes(x = ligand, y = value, group = boxgroup, color = lig_type)) + geom_jitter(width = 0.1, shape = 21, stroke = 1) + #facet_grid(rec ~ .) + scale_color_aaas() + scale_y_continuous(limits = c(0,1.5)) + #coord_flip() + theme_light() + facet_grid(. ~ rec) print(data_dir_sensors_xls_colplot) ggsave(&quot;./sensorload_col.jpeg&quot;, data_dir_sensors_xls_colplot, width = 90, height = 45, units = c(&quot;mm&quot;)) ggsave(&quot;./sensorload_col.ps&quot;, data_dir_sensors_xls_colplot, width = 90, height = 45, units = c(&quot;mm&quot;)) ### plot raw sensor loading data Immobilization levels of the sensor columns. value=BLI nm, MUT0 = wild-type, MUT1=mutants as described. BOTH=comoparative experiment, CAP/USP=titration experiments. The GFP-ligand fusion constructs were immobilized on the sensor surfaces mainly for three reasons: (1) the fused ligands comprise short peptide sequences without forming any complex domain structures, so that any regeneration procedure should not have any negative effect on their structure or function (2) most prob GFP is almost always the entity that is coupled to the surface so that the fused ligand is freely available for interaction (3) unfolding/denaturation of GFP due to regeneration should not have a major impact on the binding of NTF2 to the ligand, but may present free hydophobic residues for competetive interaction with NTF2. 3.5 Sensor stability In order to verfiy that the regeneration procedure did not negatively impact the NTF2:ligand interactions, the same NTF2 concentration of 500 nM was applied in all titration experiments, in order to track the binding levels in each experiment: data_pall_csv_conc_titrations_ligand_eq_stab &lt;- data_pall_csv_conc_titrations_eq %&gt;% dplyr::filter(., rec != &quot;BOTH&quot; &amp; conc_nM == 1000) %&gt;% mutate(csv_shifted_eqphase = purrr::map(csv_shifted, ~filter(.,time_shifted &gt; 1150 &amp; time_shifted &lt; 1200))) %&gt;% mutate(csv_shifted_eqvalue = purrr::map(csv_shifted_eqphase, ~summarize(.,octet_eq = mean(octet)))) data_pall_csv_conc_titrations_ligand_eq_stab_comb_plot &lt;- data_pall_csv_conc_titrations_ligand_eq_stab %&gt;% dplyr::select(rec, exprun_digit, octet_eq) %&gt;% group_by(., rec) %&gt;% dplyr::mutate(., index = row_number(rec)) %&gt;% ggplot(data=., aes(x=index, y=octet_eq)) + #xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + geom_point(size=2) + geom_line(size = 0.5) + scale_y_continuous(limits = c(0,1)) + #scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3.7, trans = &quot;log10&quot;) + #, scale_color_aaas() + theme_light() + facet_grid(rec ~ .) print(data_pall_csv_conc_titrations_ligand_eq_stab_comb_plot) ggsave(filename=&quot;ggplot_sensor_stability.jpeg&quot;, plot=data_pall_csv_conc_titrations_ligand_eq_stab_comb_plot, width = 80, height = 50, units = c(&quot;mm&quot;)) ggsave(filename=&quot;ggplot_sensor_stability.ps&quot;, plot=data_pall_csv_conc_titrations_ligand_eq_stab_comb_plot,width = 80, height = 50, units = c(&quot;mm&quot;)) Binding levels of NTF2 to the ligands immobilized on the surface were relatively stable for both CAP and USP. However, NTF2 bindin to CAP was slighly higher in the first four titration runs. This was most probably due to a slight mismatch in concentration while preparing the NTF2 solutions from two different batches. Index correponds to titration round. 3.6 Hill fit to pseudo-equilibrium data pre-load fits - required for the knitted document #for knitting load(&quot;fits.Rdata&quot;) this chunk would run the fitting if # is removed # Hill-fit https://doi.org/10.1016/j.vascn.2014.08.006 #KD fit: taken from MST publication ##Langmuir isotherm O’Shannessy (1996) ANALYTICAL BIOCHEMISTRY norm_purrr_f &lt;- function(df){ octet_max &lt;- 0.7 #max(octet_eq) df_norm &lt;- df %&gt;% mutate(., octet_norm = ((octet_eq-min(octet_eq))/(octet_max-min(octet_eq))), conc_nM_dimer = conc_nM/2) return(df_norm) } ## taken out only for knitting #data_pall_csv_conc_titrations_ligand_eq_fit &lt;- data_pall_csv_conc_titrations_ligand_eq %&gt;% dplyr::filter(., sampleid != &quot;AR2Gx05xCAPxEXP04&quot;) %&gt;% dplyr::select(-csv_shifted, -csv_shifted_eqphase) %&gt;% group_by(rec) %&gt;% nest() %&gt;% mutate(data_norm = purrr::map(data,~norm_purrr_f(.))) %&gt;% mutate(eq_KD_fit = purrr::map(data,~nlsLM(octet_eq ~ (R*conc_nM_dimer/(KD_eq+conc_nM_dimer)), start = list(R=0.7,KD_eq=50), lower=c(0.6,10^-12), upper=c(1.2,Inf), data=.,weights = (1/octet_eq)))) %&gt;% mutate(KD_results = map(eq_KD_fit, augment)) %&gt;% mutate(eq_Hill_fit = purrr::map(data,~nlsLM(octet_eq ~ (octet_zero+(octet_max-octet_zero)/(1+(EC50/conc_nM_dimer)^hslope ) ), start = list(octet_max=0.8, octet_zero=0, EC50=100,hslope=1), lower=c(0.5, 0, 1, 0.3), upper=c(0.9, 0, 2000, 2), data=., weights = (1/octet_eq)))) %&gt;% mutate(hill_results = map(eq_Hill_fit, augment)) %&gt;% mutate(kd_results = map(eq_KD_fit, augment)) %&gt;% mutate(kd_pars = map(eq_KD_fit, tidy)) %&gt;% mutate(hill_pars = map(eq_Hill_fit, tidy)) %&gt;% mutate(hill_results_mod = purrr::map(hill_results, ~dplyr::select(., octet_eq, conc_nM_dimer, hill_fit = &quot;.fitted&quot;))) %&gt;% mutate(kd_results_mod = purrr::map(kd_results, ~dplyr::select(., octet_eq, conc_nM_dimer, kd_fit = &quot;.fitted&quot;))) ### write fit parameters as csv files data_pall_csv_conc_titrations_ligand_eq_fit_pars_table &lt;- data_pall_csv_conc_titrations_ligand_eq_fit %&gt;% mutate(., hill_pars_long = purrr::map(hill_pars, ~pivot_longer(., 2:5, names_to = &quot;hill_stats&quot;, values_to = &quot;hill_stats_value&quot;)), kd_pars_long = purrr::map(kd_pars, ~pivot_longer(., 2:5, names_to = &quot;kd_stats&quot;, values_to = &quot;kd_stats_value&quot;)) ) %&gt;% mutate(., hill_pars_long_names = purrr::map(hill_pars_long, ~dplyr::select(., hill_term = term, 2:3)), kd_pars_long_names = purrr::map(kd_pars_long, ~dplyr::select(., kd_term = term, 2:3)) )%&gt;% dplyr::select(rec, hill_pars_long_names, kd_pars_long_names) data_pall_csv_conc_titrations_ligand_eq_fit_hill_estimate &lt;- data_pall_csv_conc_titrations_ligand_eq_fit_pars_table %&gt;% dplyr::select(., hill_pars_long_names) %&gt;% unnest(., c(&quot;hill_pars_long_names&quot;)) %&gt;% dplyr::filter(., (hill_term == &quot;EC50&quot; | hill_term == &quot;hslope&quot;) &amp; (hill_stats == &quot;estimate&quot; | hill_stats == &quot;std.error&quot;)) data_pall_csv_conc_titrations_ligand_eq_fit_hill_estimate_vline &lt;- data_pall_csv_conc_titrations_ligand_eq_fit_hill_estimate %&gt;% pivot_wider(., id_cols = c(&quot;rec&quot;, &quot;hill_term&quot;), names_from = c(&quot;hill_stats&quot;), values_from = c(&quot;hill_stats_value&quot;)) %&gt;% dplyr::filter(., hill_term == &quot;EC50&quot;) %&gt;% dplyr::mutate(., vline_estimate = estimate, vline_plus = estimate+std.error, vline_minus = estimate-std.error) %&gt;% dplyr::select(., -hill_term, -std.error, -estimate) %&gt;% pivot_longer(., c(2:ncol(.))) %&gt;% dplyr::select(., rec, vline_name = name, vline_value = value) %&gt;% dplyr::mutate(., vline_size = case_when(vline_name == &quot;vline_estimate&quot; ~ 2, vline_name == &quot;vline_plus&quot; ~ 1, vline_name == &quot;vline_minus&quot; ~ 1)) data_pall_csv_conc_titrations_ligand_eq_fit_pars_table %&gt;% dplyr::select(., hill_pars_long_names) %&gt;% unnest(., c(&quot;hill_pars_long_names&quot;)) %&gt;% write_csv2(.,path = &quot;./ggplot_ligand_titrations_eqconc_fit_hill_pars.csv&quot;) data_pall_csv_conc_titrations_ligand_eq_fit_pars_table %&gt;% dplyr::select(., kd_pars_long_names) %&gt;% unnest(., c(&quot;kd_pars_long_names&quot;)) %&gt;% write_csv2(.,path = &quot;./ggplot_ligand_titrations_eqconc_fit_kd_pars.csv&quot;) ###plot Kd, Hill fit data_pall_csv_conc_titrations_ligand_eq_fit_kd &lt;- data_pall_csv_conc_titrations_ligand_eq_fit %&gt;% dplyr::select(rec, kd_results_mod) %&gt;% unnest(kd_results_mod) data_pall_csv_conc_titrations_ligand_eq_fit_hill &lt;- data_pall_csv_conc_titrations_ligand_eq_fit %&gt;% dplyr::select(rec, hill_results_mod) %&gt;% unnest(., hill_results_mod) data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill &lt;- data_pall_csv_conc_titrations_ligand_eq_fit_kd %&gt;% left_join(.,data_pall_csv_conc_titrations_ligand_eq_fit_hill) data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill_plot &lt;- data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill %&gt;% dplyr::mutate(., gglegend = case_when(rec == &quot;USP&quot; ~ &quot;awt&quot;,rec == &quot;CAP&quot; ~ &quot;awt&quot;)) %&gt;% left_join(., data_pall_csv_conc_titrations_ligand_eq_fit_hill_estimate_vline) %&gt;% ggplot(data=., aes(x=conc_nM_dimer, y=octet_eq, color=gglegend)) + #xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + geom_point(size = 1, shape = 21, stroke = 1) + #geom_line(aes(x=conc_nM_dimer, y=kd_fit)) + geom_line(aes(x=conc_nM_dimer, y=hill_fit)) + scale_x_log10() + #scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #, facet_grid(rec ~ .) + scale_y_continuous(limits = c(0,1.0)) + scale_color_aaas() + geom_vline(aes(xintercept = vline_value, linetype = factor(vline_size*-1))) + theme_light() + theme(legend.position = &quot;none&quot;) print(data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill_plot) ggsave(file=&quot;ggplot_ligand_titrations_eqconc_fit.jpeg&quot;, plot=data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill_plot,device=&quot;jpeg&quot;, width = 60, height = 90, units = c(&quot;mm&quot;)) ggsave(file=&quot;ggplot_ligand_titrations_eqconc_fit.ps&quot;, plot=data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill_plot,device=&quot;ps&quot;, width = 60, height = 90, units = c(&quot;mm&quot;)) Pseudo-eq binding data were fit using Hill equation. Shown in panel C of Figure 2. 3.7 mutant control data Immobilized mutant and wild-type ligands on the surface, NTF2 as analyte. In ITC the ligand mutants were non-binders. However, BLI revealed approximated 10x reduced binding. data_pall_csv_conc_titrations_mutants &lt;- data_dir_all_csv_titrations %&gt;% dplyr::filter(., meas_type == &quot;mut&quot;) %&gt;% dplyr::filter(., exprun_digit &gt; 7) %&gt;% group_by(., rec) %&gt;% group_modify(., ~mutate(.,index=group_indices(.,exprun_digit))) %&gt;% ungroup() %&gt;% mutate(analyte = case_when(sensor == &quot;A&quot; ~ &quot;USP&quot;, sensor == &quot;B&quot; ~ &quot;USP&quot;, sensor == &quot;C&quot; ~ &quot;USPdFdF&quot;, sensor == &quot;D&quot; ~ &quot;CAP&quot;, sensor == &quot;E&quot; ~ &quot;CAP&quot;, sensor == &quot;F&quot; ~ &quot;CAPdFdL&quot;, sensor == &quot;G&quot; ~ &quot;USP&quot;, TRUE ~ &quot;ELSE&quot;)) %&gt;% mutate(., analyte_group = str_extract(analyte, &quot;USP|CAP&quot;)) %&gt;% dplyr::mutate(., analyte_type = case_when(analyte == &quot;CAP&quot; ~ &quot;MUT0&quot;, analyte == &quot;CAPdFdL&quot; ~ &quot;MUT1&quot;, analyte == &quot;USP&quot; ~ &quot;MUT0&quot;, analyte == &quot;USPdFdF&quot; ~ &quot;MUT1&quot;,)) %&gt;% mutate(csv_shifted_eqphase = purrr::map(csv_shifted, ~filter(.,time_shifted &gt; 1150 &amp; time_shifted &lt; 1200))) %&gt;% mutate(csv_shifted_eqvalue = purrr::map(csv_shifted_eqphase, ~summarize(.,octet_eq = mean(octet)))) %&gt;% unnest(., c(&quot;csv_shifted_eqvalue&quot;)) data_pall_csv_conc_titrations_mutants_100nM_figplot &lt;- data_pall_csv_conc_titrations_mutants %&gt;% dplyr::mutate(., gglegend = case_when(analyte == &quot;CAP&quot; ~ &quot;awt&quot;,analyte == &quot;USP&quot; ~ &quot;awt&quot;,analyte == &quot;USPdFdF&quot; ~ &quot;bmut&quot;, analyte == &quot;CAPdFdL&quot; ~ &quot;bmut&quot;)) %&gt;% mutate(., box_group = paste(analyte, conc_nM_dimer, sep = &quot;_&quot;)) %&gt;% dplyr::filter(., index == 1) %&gt;% dplyr::filter(., sensor != &quot;B&quot;) %&gt;% unnest(., cols = c(&quot;csv_shifted&quot;)) %&gt;% ggplot(data=., aes(x=time_shifted, y=octet, color = gglegend, group=factor(sampleid))) + xlab(&quot;time: min&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + geom_line(size=0.5) + scale_x_continuous(breaks = c(0, 600, 1200, 1800), labels = function(breaks) ((breaks/60))) + scale_y_continuous(limits = c(0, 1.5)) + #scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #, #facet_grid_paginate(index+conc_nM ~ analyte_group, ncol=2, nrow=3, page = i) + facet_grid(analyte_group ~ .) + scale_color_aaas() + theme_light() + theme(legend.position = &quot;none&quot;) print(data_pall_csv_conc_titrations_mutants_100nM_figplot) #facet_grid(expnumber ~ ligand+type) ggsave(filename=&quot;data_pall_csv_conc_titrations_mutants_plot_100nM.ps&quot;, data_pall_csv_conc_titrations_mutants_100nM_figplot, width = 45, height = 60, units = &quot;mm&quot;) ggsave(filename=&quot;data_pall_csv_conc_titrations_mutants_plot_100nM.jpeg&quot;, data_pall_csv_conc_titrations_mutants_100nM_figplot, width = 45, height = 60, units = &quot;mm&quot;) Mutant control data at 100 nM NTF2 concentration. Shown in panel C of Figure 2. data_pall_csv_conc_titrations_mutants_1000nM_figplot &lt;- data_pall_csv_conc_titrations_mutants %&gt;% dplyr::mutate(., gglegend = case_when(analyte == &quot;CAP&quot; ~ &quot;awt&quot;,analyte == &quot;USP&quot; ~ &quot;awt&quot;,analyte == &quot;USPdFdF&quot; ~ &quot;bmut&quot;, analyte == &quot;CAPdFdL&quot; ~ &quot;bmut&quot;)) %&gt;% mutate(., box_group = paste(analyte, conc_nM_dimer, sep = &quot;_&quot;)) %&gt;% dplyr::filter(., index == 4) %&gt;% dplyr::filter(., sensor != &quot;B&quot;) %&gt;% unnest(., cols = c(&quot;csv_shifted&quot;)) %&gt;% ggplot(data=., aes(x=time_shifted, y=octet, color = gglegend, group=factor(sampleid))) + xlab(&quot;time: min&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + geom_line(size=0.5) + scale_x_continuous(breaks = c(0, 600, 1200, 1800), labels = function(breaks) ((breaks/60))) + scale_y_continuous(limits = c(0, 1.5)) + #scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #, #facet_grid_paginate(index+conc_nM ~ analyte_group, ncol=2, nrow=3, page = i) + facet_grid(analyte_group ~ .) + scale_color_aaas() + theme_light() + theme(legend.position = &quot;none&quot;) print(data_pall_csv_conc_titrations_mutants_1000nM_figplot) #facet_grid(expnumber ~ ligand+type) ggsave(filename=&quot;data_pall_csv_conc_titrations_mutants_plot_1000nM.ps&quot;, data_pall_csv_conc_titrations_mutants_1000nM_figplot, width = 45, height = 60, units = &quot;mm&quot;) ggsave(filename=&quot;data_pall_csv_conc_titrations_mutants_plot_1000nM.jpeg&quot;, data_pall_csv_conc_titrations_mutants_1000nM_figplot, width = 45, height = 60, units = &quot;mm&quot;) Mutant control data at 1000 nM NTF2 concentration. Shown in panel B of Supplemental Figure S4. data_dir_sensors_USPCAP_colplot &lt;- data_dir_sensors_raw_xls %&gt;% dplyr::filter(., sample_test != &quot;USPCAP&quot;) %&gt;% drop_na(meas_type) %&gt;% dplyr::select(rec, exprun_digit, meas_type, xls_load) %&gt;% unnest(., c(&quot;xls_load&quot;)) %&gt;% left_join(., sensor_plot_tribble) %&gt;% dplyr::mutate(., boxgroup = paste(rec, ligand, lig_type, sep = &quot;_&quot;)) %&gt;% ggplot(., aes(x = meas_type, y = value, group = boxgroup, color = lig_type)) + geom_jitter(width = 0.1, shape = 21, stroke = 1) + geom_boxplot() + #facet_grid(rec ~ .) + scale_color_aaas() + #scale_x_continuous() + scale_y_continuous(&quot;octet: nm&quot;) + #coord_flip() + theme_light() + coord_cartesian(ylim = c(0, 1)) + theme(legend.position = &quot;none&quot;) + facet_grid(rec ~ .) #print(data_dir_sensors_xls_colplot) ggsave(&quot;./sensorload_USPCAP_col.jpeg&quot;, data_dir_sensors_USPCAP_colplot, width = 45, height = 90, units = c(&quot;mm&quot;)) ggsave(&quot;./sensorload_USPCAP_col.ps&quot;, data_dir_sensors_USPCAP_colplot, width = 45, height = 90, units = c(&quot;mm&quot;)) ### plot raw sensor loading data Sensorload kinetic data. data_dir_sensors_BOTH_colplot &lt;- data_dir_sensors_raw_xls %&gt;% dplyr::filter(., sample_test == &quot;USPCAP&quot;) %&gt;% drop_na(meas_type) %&gt;% dplyr::select(rec, exprun_digit, meas_type, xls_load) %&gt;% unnest(., c(&quot;xls_load&quot;)) %&gt;% left_join(., sensor_plot_tribble) %&gt;% dplyr::mutate(., boxgroup = paste(rec, ligand, lig_type, sep = &quot;_&quot;)) %&gt;% ggplot(., aes(x = lig_type, y = value, group = boxgroup, color = lig_type)) + geom_jitter(width = 0.1, shape = 21, stroke = 1) + geom_boxplot() + #facet_grid(rec ~ .) + scale_color_aaas() + #scale_x_continuous() + scale_y_continuous(&quot;octet: nm&quot;) + #coord_flip() + theme_light() + coord_cartesian(ylim = c(0, 1.5)) + theme(legend.position = &quot;none&quot;) + facet_grid(ligand ~ .) #print(data_dir_sensors_xls_colplot) ggsave(&quot;./sensorload_BOTH_col.jpeg&quot;, data_dir_sensors_BOTH_colplot, width = 45, height = 90, units = c(&quot;mm&quot;)) ggsave(&quot;./sensorload_BOTH_col.ps&quot;, data_dir_sensors_BOTH_colplot, width = 45, height = 90, units = c(&quot;mm&quot;)) Figures illustrate the loading of the sensors with the two ligands through amino-coupling. The final ligand levels are at similar octet levels of about 0.8 nm. Immobilization levels reported for both the titration (separate CAP and USP) and mutant control data (BOTH). Wild-type and mutant in blue and red, respectively. ### mutant eq boxplot data_pall_csv_conc_titrations_mutant_eq &lt;- data_pall_csv_conc_titrations_mutants %&gt;% dplyr::filter(., sensor != &quot;B&quot;) %&gt;% group_by(analyte, conc_nM_dimer) %&gt;% group_modify(., ~mutate(.,median_group=median(octet_eq))) %&gt;% ungroup() %&gt;% group_by(analyte_group) %&gt;% group_modify(., ~mutate(.,max_ana_group=max(median_group))) %&gt;% group_modify(., ~mutate(., octet_eq_norm = (octet_eq/max_ana_group*100))) data_pall_csv_conc_titrations_mutant_eq_logplot &lt;- data_pall_csv_conc_titrations_mutant_eq %&gt;% dplyr::mutate(., gglegend = case_when(analyte == &quot;CAP&quot; ~ &quot;awt&quot;,analyte == &quot;USP&quot; ~ &quot;awt&quot;,analyte == &quot;USPdFdF&quot; ~ &quot;bmut&quot;, analyte == &quot;CAPdFdL&quot; ~ &quot;bmut&quot;)) %&gt;% mutate(., box_group = paste(analyte, conc_nM_dimer, sep = &quot;_&quot;)) %&gt;% ggplot(data=., aes(x = conc_nM_dimer, y=octet_eq, color=gglegend, group=factor(box_group))) + #xlab(&quot;Vol /mL&quot;) + #ylab(&quot;Abs /mAU&quot;) +#xlim(c(0,1000)) +#ylim(c(-5,50)) + #geom_vline(xintercept = mwlines, color = &quot;red&quot;, linetype=&quot;dashed&quot;, size=0.5) + geom_boxplot(position = &quot;identity&quot;) + geom_jitter(size = 1, shape = 21, stroke = 1, width = 0.2) + scale_x_log10(breaks = c(50, 500)) + #scale_y_continuous() + coord_cartesian(ylim = c(0, 1.5)) + #scale_color_gradient2(low=&quot;green&quot;, mid=&quot;blue&quot;, high=&quot;red&quot;, space =&quot;Lab&quot;,midpoint=3, trans = &quot;log10&quot;) + #, facet_grid(analyte_group ~ .) + scale_color_aaas() + theme_light() + theme(legend.position = &quot;none&quot;) print(data_pall_csv_conc_titrations_mutant_eq_logplot) # facet_grid(expnumber ~ ligand+type) ggsave(filename=&quot;data_pall_csv_conc_titrations_mutants_logplot_0.ps&quot;, width = 45, height = 60, units = &quot;mm&quot;) ggsave(filename=&quot;data_pall_csv_conc_titrations_mutants_logplot_0.jpeg&quot;, width = 45, height = 60, units = &quot;mm&quot;) Boxplots of mutant control data at the two tested concentrations. Shown in panel B of Supplemental Figure S4. 4 assembles figures 4.1 main figure # data_dir_sensors_USPCAP_colplot, data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill_plot, data_pall_csv_conc_titrations_mutants_figplot, data_dir_sensors_BOTH_colplot octet_combined_plot &lt;- ggpubr::ggarrange(data_pall_csv_conc_titrations_ligand_eq_fit_kd_hill_plot, data_dir_sensors_USPCAP_colplot, data_pall_csv_conc_titrations_mutants_100nM_figplot, data_dir_sensors_BOTH_colplot, nrow = 1, ncol = 4, widths = c(2,1,2,1), align = c(&quot;hv&quot;)) ggsave(file=&quot;octet_main_plotggplot.jpeg&quot;, plot=octet_combined_plot,device=&quot;jpeg&quot;, width = 160, height = 60, units = c(&quot;mm&quot;)) ggsave(file=&quot;octet_main_plotggplot.ps&quot;, plot=octet_combined_plot,device=&quot;ps&quot;, width = 160, height = 60, units = c(&quot;mm&quot;)) print(octet_combined_plot) Pre-assembled Figure 2. Sensorloads were removed from the Figure in the manuscript. 4.2 supplement figure # octet_supplement_plot &lt;- ggpubr::ggarrange(data_dir_all_csv_titrations_plot, data_pall_csv_conc_titrations_mutants_1000nM_figplot, data_pall_csv_conc_titrations_mutant_eq_logplot, nrow = 1, ncol = 3, widths = c(2,2,1), align = c(&quot;hv&quot;)) ggsave(file=&quot;octet_supplement_plotggplot.jpeg&quot;, plot=octet_supplement_plot,device=&quot;jpeg&quot;, width = 160, height = 60, units = c(&quot;mm&quot;)) ggsave(file=&quot;octet_supplement_plotggplot.ps&quot;, plot=octet_supplement_plot,device=&quot;ps&quot;, width = 160, height = 60, units = c(&quot;mm&quot;)) print(octet_supplement_plot) Pre-assembled Figure S4. Plots were saved as postscript files, and edited into publication-quality figures using Adobe Illustrator. The bookdown document was created based on bookdown, and rtemps. Note that the echo = FALSE parameter was added to the code chunk to prevent printing of the R code that generated the plot. "]]
